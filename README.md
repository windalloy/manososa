# manososa - é­”å¥³æœæŸ¥æ¸¸æˆ

ä¸€ä¸ªåŸºäº AI çš„äº¤äº’å¼æ¨ç†æ¸¸æˆç³»ç»Ÿï¼Œç©å®¶å¯ä»¥ä¸è§’è‰²å¯¹è¯ã€æ”¶é›†è¯ç‰©ã€è°ƒæŸ¥çº¿ç´¢ï¼Œæœ€ç»ˆæ¨ç†å‡ºçœŸç›¸ã€‚

## ğŸ“‹ ç›®å½•

- [è‡´è°¢](#è‡´è°¢)
- [é¡¹ç›®ç®€ä»‹](#é¡¹ç›®ç®€ä»‹)
- [æŠ€æœ¯æ ˆ](#æŠ€æœ¯æ ˆ)
- [é¡¹ç›®ç»“æ„](#é¡¹ç›®ç»“æ„)
- [é‡è¦æ–‡ä»¶è¯´æ˜](#é‡è¦æ–‡ä»¶è¯´æ˜)
- [æœ¬åœ°éƒ¨ç½²](#æœ¬åœ°éƒ¨ç½²)
- [æœåŠ¡å™¨éƒ¨ç½²](#æœåŠ¡å™¨éƒ¨ç½²)
- [é…ç½®è¯´æ˜](#é…ç½®è¯´æ˜)
- [å¦‚ä½•ç¼–å†™è‡ªå·±çš„å‰§æœ¬](#å¦‚ä½•ç¼–å†™è‡ªå·±çš„å‰§æœ¬)
- [å¸¸è§é—®é¢˜](#å¸¸è§é—®é¢˜)

## ğŸ™ è‡´è°¢

æœ¬é¡¹ç›®åŸºäºå¹¶å€Ÿé‰´äº† [AI Alibis: Multi-Agent LLM Murder Mystery](https://github.com/ironman5366/ai-murder-mystery-hackathon) é¡¹ç›®ã€‚æ„Ÿè°¢åŸé¡¹ç›®ä½œè€…çš„å¼€æºè´¡çŒ®ï¼Œä¸ºæœ¬é¡¹ç›®æä¾›äº†é‡è¦çš„æŠ€æœ¯åŸºç¡€å’Œè®¾è®¡çµæ„Ÿã€‚

## ğŸ® é¡¹ç›®ç®€ä»‹

manososa æ˜¯ä¸€ä¸ªåŸºäºå¤§è¯­è¨€æ¨¡å‹çš„äº¤äº’å¼æ¨ç†æ¸¸æˆç³»ç»Ÿï¼ˆé­”å¥³æœæŸ¥æ¸¸æˆï¼‰ã€‚ç©å®¶æ‰®æ¼”ä¾¦æ¢ï¼Œé€šè¿‡ï¼š
- **è°ƒæŸ¥**ï¼šå‰å¾€å„ä¸ªåœ°ç‚¹å¯»æ‰¾çº¿ç´¢å’Œè¯ç‰©
- **è¯¢é—®**ï¼šä¸è§’è‰²å¯¹è¯ï¼Œè·å–è¯è¨€
- **å‡ºç¤º**ï¼šå‘è§’è‰²å‡ºç¤ºè¯ç‰©ï¼Œæ”¹å˜ä»–ä»¬çš„è¯è¨€
- **æ¨ç†**ï¼šåˆ©ç”¨å…³é”®è¯è¨€æ­éœ²çŸ›ç›¾

æœ€ç»ˆåœ¨æœ‰é™çš„è¡ŒåŠ¨æ¬¡æ•°å†…æ‰¾å‡ºçœŸç›¸ã€‚

## ğŸ›  æŠ€æœ¯æ ˆ

### å‰ç«¯
- **React 18** + **TypeScript**
- **Mantine UI** - UI ç»„ä»¶åº“
- **React Scripts** - æ„å»ºå·¥å…·

### åç«¯
- **FastAPI** - Python Web æ¡†æ¶
- **DeepSeek** - AI æ¨¡å‹æ”¯æŒ

## ğŸ“ é¡¹ç›®ç»“æ„

```
manososa/
â”œâ”€â”€ api/                    # åç«¯æœåŠ¡
â”‚   â”œâ”€â”€ main.py            # FastAPI ä¸»å…¥å£
â”‚   â”œâ”€â”€ ai.py              # AI è°ƒç”¨é€»è¾‘
â”‚   â”œâ”€â”€ settings.py        # é…ç½®ç®¡ç†
â”‚   â”œâ”€â”€ invoke_types.py   # ç±»å‹å®šä¹‰
â”‚   â”œâ”€â”€ requirements.txt   # Python ä¾èµ–
â”‚   â””â”€â”€ .env              # ç¯å¢ƒå˜é‡é…ç½®ï¼ˆéœ€åˆ›å»ºï¼‰
â”‚
â”œâ”€â”€ web/                    # å‰ç«¯åº”ç”¨
â”‚   â”œâ”€â”€ src/
â”‚   â”‚   â”œâ”€â”€ pages/
â”‚   â”‚   â”‚   â””â”€â”€ Home.tsx   # ä¸»é¡µé¢ç»„ä»¶
â”‚   â”‚   â”œâ”€â”€ components/    # React ç»„ä»¶
â”‚   â”‚   â”œâ”€â”€ config/        # é…ç½®æ–‡ä»¶
â”‚   â”‚   â”œâ”€â”€ assets/        # å›¾ç‰‡èµ„æº
â”‚   â”‚   â”œâ”€â”€ characters.json # è§’è‰²æ•°æ®
â”‚   â”‚   â”œâ”€â”€ evidence.json  # è¯ç‰©æ•°æ®
â”‚   â”‚   â”œâ”€â”€ context2Mapping.json # è¯ç‰©-è¯è¨€æ˜ å°„
â”‚   â”‚   â””â”€â”€ constants.ts   # å¸¸é‡é…ç½®
â”‚   â”œâ”€â”€ package.json       # Node.js ä¾èµ–
â”‚   â””â”€â”€ public/            # é™æ€èµ„æº
â”‚
â””â”€â”€ README.md              # æœ¬æ–‡ä»¶
```

## ğŸ“„ é‡è¦æ–‡ä»¶è¯´æ˜

### åç«¯æ–‡ä»¶

#### `api/main.py`
- **ä½œç”¨**ï¼šFastAPI åº”ç”¨ä¸»å…¥å£ï¼Œå¤„ç†æ‰€æœ‰ API è¯·æ±‚
- **å…³é”®åŠŸèƒ½**ï¼š
  - `/invoke/` - å¤„ç† AI å¯¹è¯è¯·æ±‚
  - ä¸º"äºŒé˜¶å ‚å¸Œç½—"è§’è‰²çš„å›å¤æ·»åŠ æ‹¬å·ï¼ˆè¡¨ç¤ºå†…å¿ƒç‹¬ç™½ï¼‰

#### `api/ai.py`
- **ä½œç”¨**ï¼šAI æ¨¡å‹è°ƒç”¨å’Œæç¤ºè¯ç®¡ç†
- **å…³é”®å‡½æ•°**ï¼š
  - `get_actor_prompt()` - ç”Ÿæˆè§’è‰²æç¤ºè¯
  - `get_system_prompt()` - ç”Ÿæˆç³»ç»Ÿæç¤ºè¯
  - `invoke_anthropic()` / `invoke_openai()` ç­‰ - è°ƒç”¨ä¸åŒ AI æœåŠ¡
- **ç‰¹æ®Šå¤„ç†**ï¼šä¸º"äºŒé˜¶å ‚å¸Œç½—"è§’è‰²ä½¿ç”¨è„‘å†…å›æƒ³æ¨¡å¼çš„æç¤ºè¯

#### `api/settings.py`
- **ä½œç”¨**ï¼šè¯»å–ç¯å¢ƒå˜é‡ï¼Œé…ç½® AI æœåŠ¡
- **æ”¯æŒçš„ AI æœåŠ¡**ï¼š
  - DeepSeekï¼ˆé»˜è®¤ï¼‰
  - Anthropic Claude
  - OpenAI
  - Groq
  - OpenRouter
  - Ollamaï¼ˆæœ¬åœ°éƒ¨ç½²ï¼‰

### å‰ç«¯æ–‡ä»¶

#### `web/src/pages/Home.tsx`
- **ä½œç”¨**ï¼šä¸»é¡µé¢ç»„ä»¶ï¼Œç®¡ç†å…¨å±€çŠ¶æ€å’Œæ¸¸æˆæµç¨‹
- **å…³é”®åŠŸèƒ½**ï¼š
  - è§’è‰²åˆ‡æ¢å’Œå¯¹è¯ç®¡ç†
  - è¯ç‰©å±•ç¤ºå’Œå‡ºç¤ºé€»è¾‘
  - åœ°å›¾äº¤äº’
  - èƒŒæ™¯å’Œç«‹ç»˜åˆ‡æ¢
  - è¡ŒåŠ¨æ¬¡æ•°ç®¡ç†

#### `web/src/components/Actor.tsx`
- **ä½œç”¨**ï¼šå•ä¸ªè§’è‰²çš„å¯¹è¯ç•Œé¢ç»„ä»¶
- **åŠŸèƒ½**ï¼š
  - æ¶ˆæ¯æ˜¾ç¤ºå’Œè¾“å…¥
  - AI å¯¹è¯è°ƒç”¨
  - é”®ç›˜å¿«æ·é”®ï¼ˆEnter å‘é€/ç»§ç»­ï¼‰

#### `web/src/components/EvidenceDisplay.tsx`
- **ä½œç”¨**ï¼šè¯ç‰©å±•ç¤ºå’Œå‡ºç¤ºç•Œé¢
- **åŠŸèƒ½**ï¼š
  - è¯ç‰©åˆ—è¡¨å±•ç¤º
  - ç‚¹å‡»è¯ç‰©å‘è§’è‰²å‡ºç¤º
  - æ ¹æ®è¯ç‰©è§¦å‘è¯è¨€æ›´æ–°
  - ç«‹ç»˜å˜ä½“åˆ‡æ¢

#### `web/src/characters.json`
- **ä½œç”¨**ï¼šå®šä¹‰æ‰€æœ‰è§’è‰²çš„æ•°æ®
- **ç»“æ„**ï¼š
  ```json
  {
    "fileKey": "stock-characters::v1",
    "globalStory": "å…¨å±€æ•…äº‹èƒŒæ™¯",
    "characters": [
      {
        "name": "è§’è‰²åç§°",
        "bio": "è§’è‰²èƒŒæ™¯",
        "personality": "æ€§æ ¼æè¿°",
        "context1": "åˆå§‹è¯è¨€",
        "context2": "å‡ºç¤ºè¯ç‰©02åçš„è¯è¨€",
        "context3": "å‡ºç¤ºè¯ç‰©03åçš„è¯è¨€",
        "context4": "å‡ºç¤ºè¯ç‰©04åçš„è¯è¨€",
        "lastcontext": "æœ€ç»ˆè¯è¨€",
        "secret": "è§’è‰²ç§˜å¯†",
        "image": "å¤´åƒæ–‡ä»¶å"
      }
    ]
  }
  ```

#### `web/src/evidence.json`
- **ä½œç”¨**ï¼šå®šä¹‰æ‰€æœ‰è¯ç‰©åŠå…¶å±æ€§
- **ç»“æ„**ï¼š
  ```json
  {
    "id": "è¯ç‰©ID",
    "name": "è¯ç‰©åç§°",
    "description": "æè¿°",
    "image": "å›¾ç‰‡æ–‡ä»¶å",
    "obtained": false
  }
  ```

#### `web/src/context2Mapping.json`
- **ä½œç”¨**ï¼šå®šä¹‰è¯ç‰©ä¸è¯è¨€çš„æ˜ å°„å…³ç³»
- **ç»“æ„**ï¼š
  ```json
  {
    "è§’è‰²åç§°": {
      "è¯ç‰©ID": "context2" | "context3" | "context4" | "lastcontext" | false
    }
  }
  ```
- **è¯´æ˜**ï¼š
  - `"context2"` - å‡ºç¤ºè¯¥è¯ç‰©åï¼Œå°†`context2` çš„å†…å®¹æ·»åŠ åˆ°context1ä¸­
  - `false` - å‡ºç¤ºè¯¥è¯ç‰©ä¸ä¼šæ”¹å˜è¯è¨€

#### `web/src/config/evidence.ts`
- **ä½œç”¨**ï¼šTypeScript ç±»å‹çš„è¯ç‰©é…ç½®
- **ç”¨é€”**ï¼šå‰ç«¯ä»£ç ä¸­ä½¿ç”¨çš„è¯ç‰©æ•°æ®ç»“æ„

#### `web/src/config/mapRegions.ts`
- **ä½œç”¨**ï¼šå®šä¹‰åœ°å›¾ä¸Šå¯ç‚¹å‡»çš„åŒºåŸŸ
- **åŠŸèƒ½**ï¼šç‚¹å‡»åœ°å›¾åŒºåŸŸå¯ä»¥åˆ‡æ¢èƒŒæ™¯ã€è·å–è¯ç‰©ç­‰

#### `web/src/constants.ts`
- **ä½œç”¨**ï¼šå®šä¹‰ API URL ç­‰å¸¸é‡
- **åŠŸèƒ½**ï¼šè‡ªåŠ¨æ£€æµ‹ç¯å¢ƒï¼ˆæœ¬åœ°/æœåŠ¡å™¨ï¼‰ï¼Œæ„å»ºæ­£ç¡®çš„ API åœ°å€

#### `web/src/assets/`
- **ä½œç”¨**ï¼šå­˜æ”¾æ‰€æœ‰å›¾ç‰‡èµ„æº
- **ç›®å½•ç»“æ„**ï¼š
  - `bg/` - èƒŒæ™¯å›¾ç‰‡ï¼ˆAVIF æ ¼å¼ï¼‰
  - `character_stand/` - è§’è‰²ç«‹ç»˜ï¼ˆWebP æ ¼å¼ï¼‰
  - `character_avatars/` - è§’è‰²å¤´åƒï¼ˆWebP æ ¼å¼ï¼‰
  - `character_name/` - è§’è‰²åç§°å›¾ç‰‡ï¼ˆWebP æ ¼å¼ï¼‰
  - `evidence/` - è¯ç‰©å›¾ç‰‡ï¼ˆWebP æ ¼å¼ï¼‰
  - `map/` - åœ°å›¾å›¾ç‰‡ï¼ˆWebP æ ¼å¼ï¼‰
  - `ui/` - UI å…ƒç´ å›¾ç‰‡ï¼ˆWebP æ ¼å¼ï¼‰

## ğŸš€ æœ¬åœ°éƒ¨ç½²

### å‰ç½®è¦æ±‚

1. **Node.js** >= 16.x
2. **Python** >= 3.8
3. **DeepSeek API Key**

### æ­¥éª¤ 1ï¼šå…‹éš†é¡¹ç›®

```bash
git clone <repository-url>
cd manososa
```

### æ­¥éª¤ 2ï¼šé…ç½®åç«¯

#### 2.1 å®‰è£… Python ä¾èµ–

```bash
cd api
pip install -r requirements.txt
```

#### 2.2 åˆ›å»ºç¯å¢ƒå˜é‡æ–‡ä»¶

åœ¨ `api/` ç›®å½•ä¸‹åˆ›å»º `.env` æ–‡ä»¶ï¼š

```env
# AI æœåŠ¡é…ç½®
INFERENCE_SERVICE=deepseek
API_KEY=your-deepseek-api-key-here
MODEL=deepseek-chat  # DeepSeek æ¨¡å‹åç§°
MAX_TOKENS=512

# Ollama é…ç½®ï¼ˆå¦‚æœä½¿ç”¨ Ollamaï¼‰
OLLAMA_URL=http://localhost:11434
```

#### 2.3 å¯åŠ¨åç«¯æœåŠ¡

```bash
# ä½¿ç”¨ uvicorn
uvicorn main:app --host 0.0.0.0 --port 10000

# æˆ–ä½¿ç”¨ run.shï¼ˆå¦‚æœå·²é…ç½®ï¼‰
bash run.sh
```

åç«¯æœåŠ¡å°†åœ¨ `http://localhost:10000` å¯åŠ¨ã€‚

### æ­¥éª¤ 3ï¼šé…ç½®å‰ç«¯

#### 3.1 å®‰è£… Node.js ä¾èµ–

```bash
cd web
npm install
```

#### 3.2 é…ç½® API URL

ç¼–è¾‘ `web/src/constants.ts`ï¼Œä¿®æ”¹ `SERVER_IP` å’Œ `SERVER_PORT`ï¼š

```typescript
const SERVER_IP = 'localhost';  // æœ¬åœ°å¼€å‘ä½¿ç”¨ localhost
const SERVER_PORT = 10000;
```

æˆ–è€…è®¾ç½®ç¯å¢ƒå˜é‡ï¼š

```bash
# Windows (PowerShell)
$env:REACT_APP_API_URL="http://localhost:10000"; npm run start

# Linux/Mac
REACT_APP_API_URL=http://localhost:10000 npm run start
```

#### 3.3 å¯åŠ¨å‰ç«¯å¼€å‘æœåŠ¡å™¨

**å¼€å‘æ¨¡å¼ï¼ˆæ¨èç”¨äºå¼€å‘ï¼‰**ï¼š

```bash
npm run start
```

å‰ç«¯å°†åœ¨ `http://localhost:3000` å¯åŠ¨ï¼Œæ”¯æŒçƒ­é‡è½½ã€‚

**ç”Ÿäº§æ¨¡å¼ï¼ˆæ„å»ºåå¯åŠ¨ï¼‰**ï¼š

å¦‚æœä½ æƒ³æµ‹è¯•ç”Ÿäº§æ„å»ºç‰ˆæœ¬ï¼š

```bash
# 1. æ„å»ºç”Ÿäº§ç‰ˆæœ¬
npm run build

# 2. å®‰è£… serveï¼ˆå¦‚æœè¿˜æ²¡æœ‰å®‰è£…ï¼‰
npm install -g serve

# 3. å¯åŠ¨é™æ€æ–‡ä»¶æœåŠ¡å™¨
cd build
serve -s . -l 3000

# æˆ–è€…ä¸€è¡Œå‘½ä»¤ï¼ˆåœ¨ web ç›®å½•ä¸‹ï¼‰
npx serve -s build -l 3000
```

æ„å»ºåçš„åº”ç”¨å°†åœ¨ `http://localhost:3000` å¯åŠ¨ã€‚

**æ³¨æ„**ï¼š
- å¼€å‘æ¨¡å¼ï¼ˆ`npm run start`ï¼‰ï¼šæ”¯æŒçƒ­é‡è½½ï¼Œé€‚åˆå¼€å‘è°ƒè¯•
- ç”Ÿäº§æ¨¡å¼ï¼ˆ`npm run build` + `serve`ï¼‰ï¼šä¼˜åŒ–åçš„é™æ€æ–‡ä»¶ï¼Œé€‚åˆæµ‹è¯•ç”Ÿäº§ç¯å¢ƒæˆ–éƒ¨ç½²

### æ­¥éª¤ 4ï¼šè®¿é—®åº”ç”¨

æ‰“å¼€æµè§ˆå™¨è®¿é—® `http://localhost:3000`ï¼Œå¼€å§‹æ¸¸æˆï¼

## ğŸŒ æœåŠ¡å™¨éƒ¨ç½²

### å‰ç½®è¦æ±‚

1. æœåŠ¡å™¨å·²å®‰è£… Node.jsã€Python
2. æœåŠ¡å™¨æœ‰å…¬ç½‘ IP æˆ–åŸŸå
3. å·²é…ç½®é˜²ç«å¢™è§„åˆ™ï¼ˆå¼€æ”¾ç«¯å£ 10000 å’Œ 3000/80ï¼‰

### æ­¥éª¤ 1ï¼šä¸Šä¼ ä»£ç 

```bash
# ä½¿ç”¨ git æˆ– scp ä¸Šä¼ ä»£ç åˆ°æœåŠ¡å™¨
scp -r . user@server:/path/to/manososa
```

### æ­¥éª¤ 2ï¼šé…ç½®åç«¯

#### 2.1 å®‰è£…ä¾èµ–

```bash
cd api
pip install -r requirements.txt
```

#### 2.2 åˆ›å»º `.env` æ–‡ä»¶

åœ¨ `api/` ç›®å½•ä¸‹åˆ›å»º `.env`ï¼š

```env
INFERENCE_SERVICE=deepseek
API_KEY=your-deepseek-api-key-here
MODEL=deepseek-chat
MAX_TOKENS=512
```

#### 2.3 ä½¿ç”¨ systemd ç®¡ç†æœåŠ¡ï¼ˆæ¨èï¼‰

åˆ›å»º `/etc/systemd/system/manososa-api.service`ï¼š

```ini
[Unit]
Description=manososa API Service
After=network.target

[Service]
Type=simple
User=your-user
WorkingDirectory=/path/to/manososa/api
Environment="PATH=/usr/bin:/usr/local/bin"
ExecStart=/usr/bin/uvicorn main:app --host 0.0.0.0 --port 10000
Restart=always

[Install]
WantedBy=multi-user.target
```

å¯åŠ¨æœåŠ¡ï¼š

```bash
sudo systemctl enable manososa-api
sudo systemctl start manososa-api
sudo systemctl status manososa-api
```

### æ­¥éª¤ 3ï¼šé…ç½®å‰ç«¯

#### 3.1 å®‰è£…ä¾èµ–

```bash
cd web
npm install
```

#### 3.2 ä¿®æ”¹ API URL

ç¼–è¾‘ `web/src/constants.ts`ï¼š

```typescript
const SERVER_IP = '47.109.192.144';  // æ›¿æ¢ä¸ºä½ çš„æœåŠ¡å™¨ IP
const SERVER_PORT = 10000;
```

#### 3.3 æ„å»ºç”Ÿäº§ç‰ˆæœ¬

```bash
npm run build
```

æ„å»ºäº§ç‰©åœ¨ `web/build/` ç›®å½•ã€‚

#### 3.4 éƒ¨ç½²é™æ€æ–‡ä»¶

**é€‰é¡¹ Aï¼šä½¿ç”¨ Nginx**

1. å®‰è£… Nginxï¼š
```bash
sudo apt install nginx
```

2. é…ç½® Nginxï¼ˆ`/etc/nginx/sites-available/manososa`ï¼‰ï¼š
```nginx
server {
    listen 80;
    server_name your-domain.com;

    root /path/to/manososa/web/build;
    index index.html;

    location / {
        try_files $uri $uri/ /index.html;
    }

    # API ä»£ç†
    location /api/ {
        proxy_pass http://localhost:10000/;
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
    }
}
```

3. å¯ç”¨é…ç½®ï¼š
```bash
sudo ln -s /etc/nginx/sites-available/manososa /etc/nginx/sites-enabled/
sudo nginx -t
sudo systemctl restart nginx
```

**é€‰é¡¹ Bï¼šä½¿ç”¨ Node.js æœåŠ¡å™¨**

ä½¿ç”¨ `serve` æˆ– `http-server`ï¼š

```bash
npm install -g serve
cd web/build
serve -s . -l 3000
```

### æ­¥éª¤ 4ï¼šé…ç½®é˜²ç«å¢™

```bash
# å¼€æ”¾ç«¯å£
sudo ufw allow 80/tcp
sudo ufw allow 10000/tcp
sudo ufw reload
```

### æ­¥éª¤ 5ï¼šéªŒè¯éƒ¨ç½²

1. è®¿é—® `http://your-server-ip` æˆ– `http://your-domain.com`
2. æ£€æŸ¥æµè§ˆå™¨æ§åˆ¶å°æ˜¯å¦æœ‰é”™è¯¯
3. æµ‹è¯•å¯¹è¯åŠŸèƒ½æ˜¯å¦æ­£å¸¸

## âš™ï¸ é…ç½®è¯´æ˜

### åç«¯é…ç½®ï¼ˆ`api/.env`ï¼‰

| å˜é‡å | è¯´æ˜ | é»˜è®¤å€¼ | ç¤ºä¾‹ |
|--------|------|--------|------|
| `INFERENCE_SERVICE` | AI æœåŠ¡æä¾›å•† | `deepseek` | `deepseek`, `anthropic`, `openai`, `groq`, `openrouter`, `ollama` |
| `API_KEY` | API å¯†é’¥ | - | `sk-xxx...` |
| `MODEL` | æ¨¡å‹åç§° | `deepseek-chat` | `deepseek-chat`, `deepseek-reasoner` ç­‰ |
| `MAX_TOKENS` | æœ€å¤§ token æ•° | `512` | `512`, `1024` |
| `OLLAMA_URL` | Ollama æœåŠ¡åœ°å€ | `http://localhost:11434` | - |

### å‰ç«¯é…ç½®ï¼ˆ`web/src/constants.ts`ï¼‰

| å˜é‡å | è¯´æ˜ | é»˜è®¤å€¼ |
|--------|------|--------|
| `SERVER_IP` | åç«¯æœåŠ¡å™¨ IP | `47.109.192.144` |
| `SERVER_PORT` | åç«¯æœåŠ¡ç«¯å£ | `10000` |
| `REACT_APP_API_URL` | API URLï¼ˆç¯å¢ƒå˜é‡ï¼‰ | - |

### å›¾ç‰‡ä¼˜åŒ–é…ç½®

é¡¹ç›®æ”¯æŒå›¾ç‰‡æ ¼å¼è½¬æ¢å’Œä¼˜åŒ–ï¼š

```bash
# å¹³è¡¡æ¨¡å¼ï¼ˆæ¨èï¼‰
npm run convert-images:balanced

# è‡ªå®šä¹‰æ¨¡å¼ï¼ˆæœ€ä¼˜åŒ–ï¼‰
npm run convert-images:custom

# æ¿€è¿›æ¨¡å¼ï¼ˆé«˜å‹ç¼©ï¼‰
npm run convert-images:aggressive
```

è¯¦è§ `web/COMPRESSION_GUIDE.md`ã€‚

## ğŸ“ å¦‚ä½•ç¼–å†™è‡ªå·±çš„å‰§æœ¬

### æ­¥éª¤ 1ï¼šå‡†å¤‡è§’è‰²æ•°æ®

ç¼–è¾‘ `web/src/characters.json`ï¼š

1. **ä¿®æ”¹ `globalStory`**ï¼šè®¾ç½®æ•…äº‹èƒŒæ™¯
2. **ä¿®æ”¹ `characters` æ•°ç»„**ï¼š
   - æ·»åŠ /åˆ é™¤è§’è‰²
   - è®¾ç½®æ¯ä¸ªè§’è‰²çš„ï¼š
     - `name` - è§’è‰²åç§°
     - `bio` - è§’è‰²èƒŒæ™¯
     - `personality` - æ€§æ ¼æè¿°
     - `context1` - åˆå§‹è¯è¨€
     - `context2` - å‡ºç¤ºç‰¹å®šè¯ç‰©åçš„è¯è¨€
     - `context3` - å‡ºç¤ºå…¶ä»–è¯ç‰©åçš„è¯è¨€
     - `context4` - å‡ºç¤ºå…¶ä»–è¯ç‰©åçš„è¯è¨€
     - `lastcontext` - æœ€ç»ˆè¯è¨€
     - `secret` - è§’è‰²ç§˜å¯†ï¼ˆAI ä¼šä¿å®ˆçš„ç§˜å¯†ï¼‰
     - `image` - å¤´åƒæ–‡ä»¶åï¼ˆæ”¾åœ¨ `web/src/assets/character_avatars/`ï¼‰

### æ­¥éª¤ 2ï¼šå‡†å¤‡è¯ç‰©æ•°æ®

ç¼–è¾‘ `web/src/evidence.json`ï¼š

```json
{
  "id": "01",
  "name": "è¯ç‰©åç§°",
  "description": "è¯ç‰©æè¿°",
  "image": "01.webp",
  "obtained": false
}
```

### æ­¥éª¤ 3ï¼šé…ç½®è¯ç‰©-è¯è¨€æ˜ å°„

ç¼–è¾‘ `web/src/context2Mapping.json`ï¼š

```json
{
  "è§’è‰²åç§°": {
    "è¯ç‰©ID": "context2",  // å‡ºç¤ºè¯¥è¯ç‰©ååˆ‡æ¢åˆ° context2
    "02": "context3",      // å‡ºç¤ºè¯ç‰©02ååˆ‡æ¢åˆ° context3
    "03": false            // å‡ºç¤ºè¯ç‰©03ä¸æ”¹å˜è¯è¨€
  }
}
```

### æ­¥éª¤ 4ï¼šå‡†å¤‡å›¾ç‰‡èµ„æº

1. **è§’è‰²ç«‹ç»˜**ï¼š
   - åŸºç¡€ç«‹ç»˜ï¼š`character_stand/{name}.png`
   - å˜ä½“ç«‹ç»˜ï¼š`character_stand/{name}_2.png`, `{name}_3.png`, `{name}_4.png`, `{name}_l.png`
   - è½¬æ¢ä¸º WebPï¼š`npm run convert-images:balanced`

2. **èƒŒæ™¯å›¾ç‰‡**ï¼š
   - æ”¾åœ¨ `assets/bg/` ç›®å½•
   - è½¬æ¢ä¸º AVIFï¼š`npm run convert-images:balanced`

3. **è¯ç‰©å›¾ç‰‡**ï¼š
   - æ”¾åœ¨ `assets/evidence/` ç›®å½•
   - å‘½åä¸º `01.png`, `02.png` ç­‰
   - è½¬æ¢ä¸º WebP

4. **è§’è‰²å¤´åƒ**ï¼š
   - æ”¾åœ¨ `assets/character_avatars/` ç›®å½•
   - å‘½åä¸º `{name}.jpg` æˆ– `{name}.png`
   - è½¬æ¢ä¸º WebP

5. **è§’è‰²åç§°å›¾ç‰‡**ï¼š
   - æ”¾åœ¨ `assets/character_name/` ç›®å½•
   - å‘½åä¸º `n_{name}.png`
   - è½¬æ¢ä¸º WebP

### æ­¥éª¤ 5ï¼šé…ç½®åœ°å›¾åŒºåŸŸï¼ˆå¯é€‰ï¼‰

ç¼–è¾‘ `web/src/config/mapRegions.ts`ï¼Œå®šä¹‰å¯ç‚¹å‡»åŒºåŸŸï¼š

```typescript
{
  x: 100,
  y: 200,
  width: 150,
  height: 100,
  bgImage: '01.avif',
  evidenceToObtain: '01',  // å¯é€‰çš„è¯ç‰©ID
  action: 'changeBackground'
}
```

### æ­¥éª¤ 6ï¼šæµ‹è¯•

1. å¯åŠ¨åç«¯å’Œå‰ç«¯
2. æµ‹è¯•å¯¹è¯åŠŸèƒ½
3. æµ‹è¯•è¯ç‰©å‡ºç¤ºåŠŸèƒ½
4. æ£€æŸ¥è¯è¨€æ˜¯å¦æ­£ç¡®åˆ‡æ¢
5. æ£€æŸ¥ç«‹ç»˜æ˜¯å¦æ­£ç¡®åˆ‡æ¢

### æç¤º

- **è§’è‰²ç§˜å¯†**ï¼šåœ¨ `secret` å­—æ®µä¸­è®¾ç½®è§’è‰²çš„ç§˜å¯†ï¼ŒAI ä¼šä¿å®ˆç§˜å¯†ï¼Œé™¤éè¢«æç«¯å¯¹è´¨
- **è¯è¨€å±‚æ¬¡**ï¼šä½¿ç”¨ `context1` â†’ `context2` â†’ `context3` â†’ `context4` â†’ `lastcontext` æ„å»ºè¯è¨€å±‚æ¬¡
- **ç«‹ç»˜å˜ä½“**ï¼šå½“è§’è‰²åˆ‡æ¢åˆ°ä¸åŒè¯è¨€æ—¶ï¼Œå¯ä»¥æ˜¾ç¤ºä¸åŒçš„ç«‹ç»˜å˜ä½“
- **ç‰¹æ®Šè§’è‰²**ï¼šå¦‚æœè¦åˆ›å»ºç±»ä¼¼"äºŒé˜¶å ‚å¸Œç½—"çš„è‡ªæˆ‘å¯¹è¯è§’è‰²ï¼Œéœ€è¦åœ¨ `api/ai.py` ä¸­æ·»åŠ ç‰¹æ®Šå¤„ç†

## â“ å¸¸è§é—®é¢˜

### Q: å¦‚ä½•æ›´æ¢ AI æ¨¡å‹ï¼Ÿ

A: ä¿®æ”¹ `api/.env` ä¸­çš„ `INFERENCE_SERVICE` å’Œ `MODEL`ï¼š

```env
INFERENCE_SERVICE=deepseek
MODEL=deepseek-chat
API_KEY=sk-xxx...
```

### Q: æœ¬åœ°å¼€å‘æ—¶ API è¿æ¥å¤±è´¥ï¼Ÿ

A: æ£€æŸ¥ï¼š
1. åç«¯æœåŠ¡æ˜¯å¦åœ¨ `http://localhost:10000` è¿è¡Œ
2. `web/src/constants.ts` ä¸­çš„ `SERVER_IP` æ˜¯å¦ä¸º `localhost`
3. æµè§ˆå™¨æ§åˆ¶å°æ˜¯å¦æœ‰ CORS é”™è¯¯

### Q: æœåŠ¡å™¨éƒ¨ç½²åå‰ç«¯æ— æ³•è¿æ¥åç«¯ï¼Ÿ

A: æ£€æŸ¥ï¼š
1. åç«¯æœåŠ¡æ˜¯å¦æ­£å¸¸è¿è¡Œï¼š`sudo systemctl status manososa-api`
2. é˜²ç«å¢™æ˜¯å¦å¼€æ”¾ç«¯å£ 10000
3. `web/src/constants.ts` ä¸­çš„ `SERVER_IP` æ˜¯å¦æ­£ç¡®
4. æµè§ˆå™¨æ§åˆ¶å°çš„ç½‘ç»œè¯·æ±‚æ˜¯å¦æˆåŠŸ

### Q: å¦‚ä½•ä¼˜åŒ–å›¾ç‰‡åŠ è½½é€Ÿåº¦ï¼Ÿ

A: 
1. ä½¿ç”¨ `npm run convert-images:balanced` è½¬æ¢å›¾ç‰‡
2. æ£€æŸ¥ `web/src/utils/imagePreloader.ts` ä¸­çš„é¢„åŠ è½½é€»è¾‘
3. ä½¿ç”¨ CDN åŠ é€Ÿï¼ˆå¦‚æœå¯ç”¨ï¼‰

### Q: å¦‚ä½•æ·»åŠ æ–°è§’è‰²ï¼Ÿ

A: 
1. åœ¨ `web/src/characters.json` ä¸­æ·»åŠ è§’è‰²æ•°æ®
2. å‡†å¤‡è§’è‰²å›¾ç‰‡ï¼ˆå¤´åƒã€ç«‹ç»˜ã€åç§°å›¾ç‰‡ï¼‰
3. åœ¨ `web/src/context2Mapping.json` ä¸­é…ç½®è¯ç‰©æ˜ å°„
4. æ›´æ–° `web/src/config/characterStandPositions.ts` å’Œ `characterNamePositions.ts`ï¼ˆå¦‚æœéœ€è¦ï¼‰

### Q: å¦‚ä½•ä¿®æ”¹æ¸¸æˆè§„åˆ™ï¼ˆè¡ŒåŠ¨æ¬¡æ•°ç­‰ï¼‰ï¼Ÿ

A: ç¼–è¾‘ `web/src/pages/Home.tsx`ï¼ŒæŸ¥æ‰¾ `MAX_ACTIONS` æˆ–ç›¸å…³é€»è¾‘ã€‚

## ğŸ“„ è®¸å¯è¯

è¯¦è§ `LICENSE.txt`ã€‚

